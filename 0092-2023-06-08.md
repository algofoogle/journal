# 8 Jun 2023

*   STM32 emulators:
    *   https://github.com/nviennot/stm32-emulator
    *   https://www.youtube.com/watch?v=h_Ptwczj-oY
    *   stm32 IDE can do it?
    *   Wokwi, but maybe not all that complete?? UART doesn't seem to engage Serial Monitor?
*   STM32 USB:
    *   [STMicro appnote on USB](https://www.st.com/resource/en/application_note/an4879-introduction-to-usb-hardware-and-pcb-guidelines-using-stm32-mcus-stmicroelectronics.pdf)
    *   [Other STMicro in-depth USB stuff](https://wiki.st.com/stm32mcu/wiki/Introduction_to_USB_with_STM32)
*   Maybe Raspberry Pi Pico (RP2040) is the way to go:
    *   I have 2 of them already. I ordered them from Element14.com in July 2022, for AU$5.80ea,
        Specifically I got the [standard Raspberry Pi Pico](https://au.element14.com/raspberry-pi/raspberry-pi-pico/raspberry-pi-32bit-arm-cortex/dp/3643332), now closer to AU$6.65.
    *   Element14 also stock the [Pico W](https://au.element14.com/raspberry-pi/raspberry-pi-pico-w/raspberry-pi-board-arm-cortex/dp/3996082?MER=TARG-MER-PLP-RECO-STM71233-1) for $11.06.
    *   DigiKey stocks the [Pico W for $9.36](https://www.digikey.com.au/en/products/detail/raspberry-pi/SC0918/16608263?s=N4IgTCBcDaIE4EMDOAHARgUznAngAhQEsDCBjAezwHcQBdAXyA) but I'm having trouble telling if that's
        inc. or ex. GST.
    *   [Pico H at DigiKey](https://www.digikey.com.au/en/products/detail/raspberry-pi/SC0917/16608257): AU$7.80
    *   They seem to have (or support) a bootloader that allows for drag-drop firmware over USB?
    *   When using Arduino framework, `Serial` defaults to using USB-CDC.
    *   **NOTE:** Unlike STM32, they do **not** have 5V-tolerant pins. Not necessarily an issue
        except unless we wanted to connect with PS/2 keyboard/mouse.
    *   Can RP2040 be an OTG host for USB keyboard/mouse??
    *   [Wokwi can simulate](https://wokwi.com/projects/366926468219352065), inc. USB-CDC `Serial` out:
        *   Good for development!
        *   Not sure if the speed is real, though, because it makes no difference if I set it to 100 or 100,000,000.
*   NOTE: RP2040/Pi-Pico might be a good choice not only for FPGA/silicon debugging, but even actually just
    as a model driver/game for Raybox.

# Raspberry Pi Pico Getting Started (with Arduino libs support)

Pi Pico Announcement: https://www.raspberrypi.com/news/raspberry-pi-pico-w-your-6-iot-platform/

Ref: https://thepihut.com/blogs/raspberry-pi-tutorials/raspberry-pi-pico-getting-started-guide

Pinout: [detail](https://cdn.shopify.com/s/files/1/0176/3274/files/Pico-R3-A4-Pinout_f22e6644-b3e4-4997-a192-961c55fc8cae.pdf?v=1664490511) and [summary](https://thepihut.com/blogs/raspberry-pi-tutorials/raspberry-pi-pico-getting-started-guide#:~:text=Raspberry%20Pi%20Pico%20GPIO%20Pins)

[RP2040](https://en.wikipedia.org/wiki/RP2040) specs:
*   264kB RAM
*   2MB flash -- actually I think this is not part of the chip, but included on the Pi Pico board:
    >   No internal flash or EEPROM memory (after reset, the boot-loader loads firmware from either external flash memory or USB bus into internal SRAM)
    ...so does this mean there is a mask-ROM bootloader that enables external (SPI) flash and/or USB reading??
*   133MHz 32-bit dual-core ARM Cortex-M0+; overclocking to 400MHz may be possible?
*   QSPI bus controller
*   DMA controller
*   2 PLLs for USB and core clocks
*   30 GPIOs, inc. 4 supporting analog inputs
*   2 UARTs
*   2 I2C
*   2 SPI
*   16 PWM
*   USB 1.1 controller and PHY **with host and device support**??
*   8 [PIO](https://en.wikipedia.org/wiki/Programmed_input%E2%80%93output) state machines
*   Debug port

Not sure:
*   Max sink/source of GPIOs
*   GPIO speed (but probably doesn't matter much)

Variants:
*   RP2040 chip has silicon variants (I guess steppings): B0, B1, and maybe B2? Corresponding [bootROM versions](https://github.com/raspberrypi/pico-bootrom) (see [tags](https://github.com/raspberrypi/pico-bootrom/tags)).
*   Pico: Standard version without WiFi or pre-soldered headers?
*   Pico W: [802.11n WiFi](https://en.wikipedia.org/wiki/IEEE_802.11n-2009) (WiFi 4 72Mbps+ 2008/2009 standard). MAYBE supports Bluetooth??
*   Pico H: pre-soldered headers.

Hardware needs:
*   Board
*   Micro USB
*   Header pins or similar

Steps:
*   We could just use MicroPython?
*   [UF2 files](https://learn.sparkfun.com/tutorials/rp2040-thing-plus-hookup-guide/uf2-bootloader) are
    apparently firmware that can be flashed over USB? Looks like the bootloader ROM makes sure the RP2040
    appears as a USB storage device to Windows.
*   Could use Windows, or Linux VM with USB pass-thru.
*   Getting started with the Arduino framework might be easiest just using the Arduino IDE, though perhaps VSCode has integrations
    that will do it? I assume the trick is to get a build 
*   Try this maybe: https://www.hackster.io/fhdm-dev/use-arduino-libraries-with-the-rasperry-pi-pico-c-c-sdk-eff55c
*   [This](https://datasheets.raspberrypi.com/pico/getting-started-with-pico.pdf) is perhaps closer to getting started with bare-metal C/C++.
*   [Arduino-pico](https://github.com/earlephilhower/arduino-pico) and [doco](https://arduino-pico.readthedocs.io/en/latest/libraries.html), plus [Arduino Pico compatibility layer](https://www.hackster.io/fhdm-dev/use-arduino-libraries-with-the-rasperry-pi-pico-c-c-sdk-eff55c) ([github](https://github.com/fhdm-dev/pico-arduino-compat)).
*   [Arduino CLI](https://arduino.github.io/arduino-cli/0.33/)

# Notes

*   What are all the different ARM Cortex-M# levels??
*   Look into different machine pin headers inc. male-to-male -- expensive from official suppliers!
*   How well can machine pin FEMALE headers be used like a breadboard, inc. proper mating for passives, dupont wires, and headers?
*   Are there also other types of thin pins or better receptacles? Could even just use a 40-pin ZIF, and that could even
    be socketed for reuse?
*   When designing DE0-Nano "wing", have an option to run both to an inline butterfly, but also with snap-off
    breadboard straddles (both DIP-centre-line, and outer edges?)
*   This [tall 40-way 0.1&Prime; header pin row](https://www.digikey.com.au/en/products/detail/sullins-connector-solutions/PRPC040SACN-RC/2776066?utm_adgroup=&utm_source=google&utm_medium=cpc&utm_campaign=PMax%20Shopping_Products&utm_term=&utm_id=go_cmp-20001736977_adg-_ad-__dev-c_ext-_prd-2776066_sig-CjwKCAjw1YCkBhAOEiwA5aN4AcWMAhzFFJU2HChTTRSf0iAb4rV1VeZCDLiUPkIpPb_c0-9vGqD3ghoCTLMQAvD_BwE&productid=2776066&gad=1&gclid=CjwKCAjw1YCkBhAOEiwA5aN4AcWMAhzFFJU2HChTTRSf0iAb4rV1VeZCDLiUPkIpPb_c0-9vGqD3ghoCTLMQAvD_BwE) could be handy.
*   Lots of [other header types](https://www.sparkfun.com/categories/381).