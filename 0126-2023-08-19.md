# 19 Aug 2023

| Previous journal: | Next journal: |
|-|-|
| [**0125**-2023-08-18.md](./0125-2023-08-18.md) | *Next journal TBA* |


# raybox-zero

## Start TT04 submission repo

[Last time](./0119-2023-07-22.md) I used the "GitHub import" method to copy the [tt04-submission-template] repo and make [tt04-solo-squash].

This time I actually forked [tt04-submission-template], since I haven't already done this. That way other people can see the fork easily,
and I can pull updates if needed:
1.  Log in to GitHub, go to [tt04-submission-template] page, and click the "Fork" button. I called it [tt04-raybox-zero].
2.  [Enable GitHub Actions](https://tinytapeout.com/faq/#when-i-commit-my-change-the-gds-action-isnt-running) in the [Actions area of the repo](https://github.com/algofoogle/tt04-raybox-zero/actions).
3.  [Enable GitHub Pages step](https://tinytapeout.com/faq/#my-github-action-is-failing-on-the-pages-part) in [Settings => Pages](https://github.com/algofoogle/tt04-raybox-zero/settings/pages).
4.  Clone the repo locally.
5.  Add [raybox-zero] as a submodule:
    ```bash
    git submodule add git@github.com:algofoogle/raybox-zero src/raybox-zero
    ```
    ...and optionally go into `src/raybox-zero` and `git checkout` a specific branch or commit if needed. In any case, the `.gitmodules` file will specify the details of the submodule.
6.  Update `info.yaml` as required, and optionally README, etc.
7.  Commit and push changes, and observe the GHAs.

**NOTE:** After doing a `git pull` in the main repo, it might also be necessary to do `git submodule update --init --recursive` to get whichever submodule version is specified in the latest commit of [tt04-raybox-zero] at the time. More info: https://devconnected.com/how-to-add-and-update-git-submodules/

## yosys-abc core dumped

After [my initial commit](https://github.com/algofoogle/tt04-raybox-zero/commit/155c28a081895d54327f6465cd6af7b8bd20c185) of the repo, I got an unexpected failure in the [`gds` action](https://github.com/algofoogle/tt04-raybox-zero/actions/runs/5911788013/job/16034593153) where [Step 1 failed](https://github.com/algofoogle/tt04-raybox-zero/actions/runs/5911788013/job/16034593153#step:3:923) because of this error:
```
67.1.1. Executing ABC.
sh: line 1:   141 Aborted                 (core dumped) "/build/bin/yosys-abc" -s -f /tmp/yosys-abc-f4KTjg/abc.script 2>&1
ERROR: ABC: execution of command ""/build/bin/yosys-abc" -s -f /tmp/yosys-abc-f4KTjg/abc.script 2>&1" failed: return code 134.
child process exited abnormally
```

From what I can tell, this is not normal. I will have to see if I can run OpenLane and do the GDS hardening locally, and maybe see if I can configure it to give me more information. If that doesn't work, I will have to try cutting back the design to tease out the cause. I wonder if it is something to do with my negative vector indices as used in my floating-point ports... hmm...



## Next steps

*   Take raybox-zero [as it currently is](https://github.com/algofoogle/raybox-zero/commit/9073f822ae4f36340257ad17ff743278d3b3e293).
*   Run `make clean_sim` in my desktop PC's MPW8 VM: Get a 19~23% run rate (23% is typical).
*   Disable map and debug overlay code.
*   Run again, and see if the performance changes: Pretty much a constant 24%.
*   Try fitting this variation of the design in TT04.
*   If it is way too big, try some optimisations, or instead try working out how big certain modules are.
    *   WARNING: Some stuff is hardcoded (e.g. `pov`), which means some synth optimisations will happen that we probably don't want.
*   Try running on FPGA.
*   Try slowing down the FPGA clock using PLL.

## Notes

*   8bitworkshop seemed to be having trouble when I tried to have more than 10 files. The 11th was not showing up after a refresh, though I also couldn't create another file with its same name (because it complained it already existed).

[tt04-submission-template]: https://github.com/TinyTapeout/tt04-submission-template
[tt04-raybox-zero]: https://github.com/algofoogle/tt04-raybox-zero
[raybox-zero]: https://github.com/algofoogle/raybox-zero
[tt04-solo-squash]: https://github.com/algofoogle/tt04-solo-squash
